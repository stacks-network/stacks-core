[package]
name = "clarity"
version = "0.0.1"
authors = [ "Jude Nelson <jude@stacks.org>",
            "Aaron Blankstein <aaron@blockstack.com>",
            "Ludo Galabru <ludovic@blockstack.com>" ]
license = "GPLv3"
homepage = "https://github.com/blockstack/stacks-blockchain"
repository = "https://github.com/blockstack/stacks-blockchain"
description = "Reference implementation of the Stacks 2.0 Blockchain"
keywords = [ "stacks", "stx", "bitcoin", "crypto", "blockstack", "decentralized", "dapps", "blockchain" ]
readme = "README.md"
edition = "2021"
resolver = "2"

[lib]
name = "clarity"
path = "./src/libclarity.rs"

[dependencies]
hashbrown = { workspace = true }
lazy_static = { workspace = true }
regex = "1"
serde = { workspace = true }
serde_derive = { workspace = true }
serde_json = { workspace = true }
slog = { workspace = true }
stacks_common = { package = "stacks-common", path = "../stacks-common", default-features = false }

# Optional dependencies for vm functionality
rand = { workspace = true, optional = true }
rand_chacha = { workspace = true , optional = true }
serde_stacker = { version = "0.1", optional = true }
integer-sqrt = { version = "0.1.3", optional = true }
rusqlite = { workspace = true, optional = true }
rstest = { version = "0.17.0", optional = true }
rstest_reuse = { version = "0.5.0", optional = true }

[dev-dependencies]
assert-json-diff = "1.0.0"
mutants = "0.0.3"

[features]
# The default feature set provides the full Clarity virtual machine with its SQLite-based
# database backend.
# To use `clarity` as a lightweight serialization/deserialization library,
# depend on it with `default-features = false`.
default = ["vm", "rusqlite"]
# Enables the complete Clarity Virtual Machine. This includes the parser, analyzer,
# cost-checking system, and execution engine. It transitively enables all necessary
# dependencies for running smart contracts. This feature is required for any on-chain
# contract execution or local contract testing.
vm = ["dep:rand", "dep:rand_chacha", "dep:serde_stacker", "dep:integer-sqrt"]
developer-mode = ["vm", "stacks_common/developer-mode"]
devtools = ["vm"]
testing = ["vm", "dep:rstest", "dep:rstest_reuse", "rusqlite"]
rusqlite = ["vm", "stacks_common/rusqlite", "dep:rusqlite"]
slog_json = ["stacks_common/slog_json"]
rollback_value_check = ["vm"]
disable-costs = ["vm"]
